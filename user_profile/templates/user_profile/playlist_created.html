{% extends "base.html" %}
{% load static %}
{% load cloudinary %}


{% block title %}FanHub Playlist Manager{% endblock %}

{% block extra_head %}
<!-- Custom CSS for user_profile application -->
<link rel="stylesheet" href="{% static 'user_profile/css/playlist_update.css' %}" />
{% endblock extra_head %}

{% block main_content %}
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<div class="container flex-start-center flex-1-1">
    <section class="flex-column-left">
        <h4>Playlist Image:</h4> 
        <div class=" featured-image-profile image-container">
        {% if playlist.featured_image %}
            {% cloudinary playlist.featured_image %} 
        {% else %}
            <img src="{% static 'images/hero_banner_slipknot.png' %}" alt="default featured image">
        </div>
        <div class="caption">
            <p>No Custom Image Was Uploaded!</p>
            <p>If you decide to share Your playlist this nice default banner will be attached.</p>
        </div>
        {% endif %}
    </section>
    <section class="playlist-card flex-column-left flex-grow-1">
        <div>
            <h3>Playlist Title:</h3>
            <p>{{ playlist.title }}</p>
        </div>
        <div>
            <h3>Playlist Description:</h3>
            <p>{{ playlist.description | linebreaks }}</p>
        </div>
        <div>
            <h3>Playlist Reference:</h3> 
            {% if playlist.reference_url %}  
            <a href="{{ playlist.reference_url }}" target="_blank" rel="noopener noreferrer">{{ playlist.reference_url }}</a>
            {% else %}
                <p>No URL Uploaded</p>    
            {% endif %}
        </div>
        <div>
            <h3>Playlist Status:</h3>
            <p>{{ playlist.get_status_display }}</p>
        </div>
    </section>
    <section class="navigation flex-column-stretch text-center">
            <div>
                <a href="{% url 'playlist_update' playlist.id %}" class="navigation-btn back-dark color-red"><strong>Edit Playlist Details and Image</strong></a>
            </div>
            <div>
                <a href="{% url 'playlist_create' %}" class="navigation-btn back-dark color-red"><strong>Create New Playlist</strong></a>
            </div>
            <div>
                <a href="{% url 'profile' %}" class="navigation-btn back-dark color-red"><strong>Back to Your Profile Page</strong></a>
            </div>
            <div id="playlist-{{ playlist.id }}">
                <form method="post" action="{% url 'toggle_playlist_status' playlist.id %}">
                    {% csrf_token %}
                    <button type="submit" class="navigation-btn back-white color-red">
                        {% if playlist.status == 1 %}
                        <strong>Remove playlist from FanHub</strong>
                        {% else %}
                        <strong>Share playlist with FanHub</strong>
                        {% endif %}
                    </button>
                </form>
            </div>
            <div>
                <a href="{% url 'playlist_delete' playlist.id %}" class="navigation-btn back-red color-white"><strong>Delete Playlist</strong></a>
            </div>
    </section>
    <section class="playlist-card flex-column-left flex-grow-1">
        <h3>Playlist Items:</h3>
        <div>
            <a href="{% url 'add_playlist_item' playlist_id=playlist.id %}" class="navigation-btn"><strong>Add Items to Your Playlist</strong></a>
        </div>
        <p>OR</p>
        <p>Click to Edit or Delete Your Playlist Items:</p>
        {% if playlist_items %}
            <ul>
                {% for item in playlist_items %}
                    <li>
                        <a href="{% url 'playlist_item_update' playlist_id=playlist.id pk=item.id %}">{{ item }}</a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No Playlist Items Yet</p>
        {% endif %}

    </section>
</div>

{% endblock %}